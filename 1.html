<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>成品三部计划</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", Arial, sans-serif;
        }
        body {
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 25px;
            font-size: 24px;
        }
        /* 表格样式 */
        .task-table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        .task-table th, .task-table td {
            border: 1px solid #ddd;
            padding: 12px 15px;
            text-align: center;
            vertical-align: middle;
        }
        .task-table th {
            background-color: #409EFF;
            color: #fff;
            font-weight: bold;
        }
        .task-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .task-table tr:hover {
            background-color: #f1f1f1;
        }
        /* 动态时间高亮 */
        .dynamic-time {
            color: #E64A19;
            font-weight: bold;
            cursor: pointer;
        }
        .current-time {
            color: #1890FF;
            font-weight: bold;
        }
        /* 红灯样式：红色圆形小图标 */
        .red-light {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #ff0000;
            box-shadow: 0 0 3px rgba(255,0,0,0.5);
        }
        /* 响应式适配 */
        @media (max-width: 768px) {
            .task-table th, .task-table td {
                padding: 8px 10px;
                font-size: 14px;
            }
            h1 {
                font-size: 20px;
            }
            .red-light {
                width: 10px;
                height: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>成品三部计划</h1>
        <table class="task-table">
            <thead>
                <tr>
                    <th>序号</th>
                    <th>任务名称</th>
                    <th>计划时间</th>
                    <th>现在时间</th>
                    <th>备注</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>成品三部一车间设备每月巡检</td>
                    <td class="dynamic-time">2026-01-28 00:00~2026-02-27 00:00</td>
                    <td class="current-time">加载中...</td>
                    <td></td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>成品三部二车间设备每月巡检</td>
                    <td class="dynamic-time">2026-01-28 00:00~2026-02-27 00:00</td>
                    <td class="current-time">加载中...</td>
                    <td></td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>成品三部一车间月度保养计划</td>
                    <td class="dynamic-time">2026-01-20 00:00~2026-02-17 00:00</td>
                    <td class="current-time">加载中...</td>
                    <td></td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>成品三部一车间每季度保养计划</td>
                    <td class="dynamic-time">2025-11-29 00:00~2026-02-25 00:00</td>
                    <td class="current-time">加载中...</td>
                    <td></td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>成品三部一车间每半年保养计划</td>
                    <td class="dynamic-time">2025-09-02 00:00~2026-02-22 00:00</td>
                    <td class="current-time">加载中...</td>
                    <td></td>
                </tr>
                <tr>
                    <td>6</td>
                    <td>成品三部二车间月度保养计划</td>
                    <td class="dynamic-time">2026-02-03 00:00~2026-03-03 00:00</td>
                    <td class="current-time">加载中...</td>
                    <td></td>
                </tr>
                <tr>
                    <td>7</td>
                    <td>成品三部二车间每季度保养计划</td>
                    <td class="dynamic-time">2025-12-13 00:00~2026-03-11 00:00</td>
                    <td class="current-time">加载中...</td>
                    <td></td>
                </tr>
                <tr>
                    <td>8</td>
                    <td>成品三部二车间每半年保养计划</td>
                    <td class="dynamic-time">2025-09-16 00:00~2026-03-08 00:00</td>
                    <td class="current-time">加载中...</td>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </div>
    <script>
        // 格式化当前时间（YYYY-MM-DD HH:mm:ss）
        function formatCurrentTime() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hour = String(now.getHours()).padStart(2, '0');
            const minute = String(now.getMinutes()).padStart(2, '0');
            const second = String(now.getSeconds()).padStart(2, '0');
            return `${year}-${month}-${day} ${hour}:${minute}:${second}`;
        }

        // 更新现在时间（实时刷新）
        function updateCurrentTime() {
            const currentTimeElements = document.querySelectorAll('.current-time');
            currentTimeElements.forEach(element => {
                element.textContent = formatCurrentTime();
            });
        }

        // 核心逻辑：判断计划结束时间是否在15天内，是则显示红灯
        function checkDeadlineAndShowLight() {
            // 15天的毫秒数：15*24*60*60*1000
            const fifteenDaysMs = 15 * 86400000;
            const rows = document.querySelectorAll('.task-table tbody tr');
            rows.forEach(row => {
                // 获取计划时间列的文本，拆分出结束时间
                const timeText = row.querySelector('.dynamic-time').textContent;
                const endTimeStr = timeText.split('~')[1].trim();
                // 转换为Date对象
                const endTime = new Date(endTimeStr);
                const now = new Date();
                // 计算时间差（结束时间 - 当前时间）
                const timeDiff = endTime - now;
                // 获取备注列
                const remarkTd = row.lastElementChild;
                // 清空原有内容，避免重复添加红灯
                remarkTd.innerHTML = '';
                // 时间差≥0（未过期）且≤15天，显示红灯
                if (timeDiff >= 0 && timeDiff <= fifteenDaysMs) {
                    const redLight = document.createElement('span');
                    redLight.className = 'red-light';
                    remarkTd.appendChild(redLight);
                }
            });
        }

        // 页面加载时初始化
        window.onload = function() {
            // 首次加载更新现在时间
            updateCurrentTime();
            // 首次执行截止时间判断，显示红灯
            checkDeadlineAndShowLight();
            // 每秒刷新一次现在时间
            setInterval(updateCurrentTime, 1000);
            // 每分钟刷新一次红灯判断（避免高频执行，可根据需求调整）
            setInterval(checkDeadlineAndShowLight, 60000);
        };
    </script>
</body>
</html>
